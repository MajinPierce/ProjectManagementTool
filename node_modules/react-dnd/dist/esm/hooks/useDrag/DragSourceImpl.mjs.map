{"version":3,"sources":["../../../../src/hooks/useDrag/DragSourceImpl.ts"],"sourcesContent":["import type { DragDropMonitor, DragSource, Identifier } from 'dnd-core'\nimport type { Connector } from '../../internals/index.js'\nimport type { DragSourceMonitor } from '../../types/index.js'\nimport type { DragObjectFactory, DragSourceHookSpec } from '../types.js'\n\nexport class DragSourceImpl<O, R, P> implements DragSource {\n\tpublic constructor(\n\t\tpublic spec: DragSourceHookSpec<O, R, P>,\n\t\tprivate monitor: DragSourceMonitor<O, R>,\n\t\tprivate connector: Connector,\n\t) {}\n\n\tpublic beginDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\n\t\tlet result: O | null = null\n\t\tif (typeof spec.item === 'object') {\n\t\t\tresult = spec.item as O\n\t\t} else if (typeof spec.item === 'function') {\n\t\t\tresult = (spec.item as DragObjectFactory<O>)(monitor)\n\t\t} else {\n\t\t\tresult = {} as O\n\t\t}\n\t\treturn result ?? null\n\t}\n\n\tpublic canDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tif (typeof spec.canDrag === 'boolean') {\n\t\t\treturn spec.canDrag\n\t\t} else if (typeof spec.canDrag === 'function') {\n\t\t\treturn spec.canDrag(monitor)\n\t\t} else {\n\t\t\treturn true\n\t\t}\n\t}\n\n\tpublic isDragging(globalMonitor: DragDropMonitor, target: Identifier) {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tconst { isDragging } = spec\n\t\treturn isDragging\n\t\t\t? isDragging(monitor)\n\t\t\t: target === globalMonitor.getSourceId()\n\t}\n\n\tpublic endDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tconst connector = this.connector\n\t\tconst { end } = spec\n\t\tif (end) {\n\t\t\tend(monitor.getItem(), monitor)\n\t\t}\n\t\tconnector.reconnect()\n\t}\n}\n"],"names":["DragSourceImpl","beginDrag","spec","monitor","result","item","canDrag","isDragging","globalMonitor","target","getSourceId","endDrag","connector","end","getItem","reconnect"],"mappings":"AAKA,MAAM,OAAOA,cAAc;IAOnBC,SAAS,GAAG,CAAC;QACnB,KAAK,CAACC,IAAI,GAAG,IAAI,CAACA,IAAI;QACtB,KAAK,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO;QAE5B,GAAG,CAACC,MAAM,GAAa,IAAI;QAC3B,EAAE,EAAE,MAAM,CAACF,IAAI,CAACG,IAAI,KAAK,CAAQ,SAAE,CAAC;YACnCD,MAAM,GAAGF,IAAI,CAACG,IAAI;QACnB,CAAC,MAAM,EAAE,EAAE,MAAM,CAACH,IAAI,CAACG,IAAI,KAAK,CAAU,WAAE,CAAC;YAC5CD,MAAM,GAAIF,IAAI,CAACG,IAAI,CAA0BF,OAAO;QACrD,CAAC,MAAM,CAAC;YACPC,MAAM,GAAG,CAAC,CAAC;QACZ,CAAC;QACD,MAAM,CAACA,MAAM,aAANA,MAAM,cAANA,MAAM,GAAI,IAAI;IACtB,CAAC;IAEME,OAAO,GAAG,CAAC;QACjB,KAAK,CAACJ,IAAI,GAAG,IAAI,CAACA,IAAI;QACtB,KAAK,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO;QAC5B,EAAE,EAAE,MAAM,CAACD,IAAI,CAACI,OAAO,KAAK,CAAS,UAAE,CAAC;YACvC,MAAM,CAACJ,IAAI,CAACI,OAAO;QACpB,CAAC,MAAM,EAAE,EAAE,MAAM,CAACJ,IAAI,CAACI,OAAO,KAAK,CAAU,WAAE,CAAC;YAC/C,MAAM,CAACJ,IAAI,CAACI,OAAO,CAACH,OAAO;QAC5B,CAAC,MAAM,CAAC;YACP,MAAM,CAAC,IAAI;QACZ,CAAC;IACF,CAAC;IAEMI,UAAU,CAACC,aAA8B,EAAEC,MAAkB,EAAE,CAAC;QACtE,KAAK,CAACP,IAAI,GAAG,IAAI,CAACA,IAAI;QACtB,KAAK,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO;QAC5B,KAAK,CAAC,CAAC,CAACI,UAAU,EAAC,CAAC,GAAGL,IAAI;QAC3B,MAAM,CAACK,UAAU,GACdA,UAAU,CAACJ,OAAO,IAClBM,MAAM,KAAKD,aAAa,CAACE,WAAW;IACxC,CAAC;IAEMC,OAAO,GAAG,CAAC;QACjB,KAAK,CAACT,IAAI,GAAG,IAAI,CAACA,IAAI;QACtB,KAAK,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO;QAC5B,KAAK,CAACS,SAAS,GAAG,IAAI,CAACA,SAAS;QAChC,KAAK,CAAC,CAAC,CAACC,GAAG,EAAC,CAAC,GAAGX,IAAI;QACpB,EAAE,EAAEW,GAAG,EAAE,CAAC;YACTA,GAAG,CAACV,OAAO,CAACW,OAAO,IAAIX,OAAO;QAC/B,CAAC;QACDS,SAAS,CAACG,SAAS;IACpB,CAAC;gBAlDOb,IAAiC,EAChCC,OAAgC,EAChCS,SAAoB,CAC3B,CAAC;aAHKV,IAAiC,GAAjCA,IAAiC;aAChCC,OAAgC,GAAhCA,OAAgC;aAChCS,SAAoB,GAApBA,SAAoB;IAC1B,CAAC"}